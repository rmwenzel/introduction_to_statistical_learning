<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      4. Logistic Regression &middot; islr
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/islr/public/css/poole.css">
  <link rel="stylesheet" href="/islr/public/css/syntax.css">
  <link rel="stylesheet" href="/islr/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/islr/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/islr/public/favicon.ico">
  --->

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!--- KaTeX --->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
      onload="renderMathInElement(document.body);"></script>
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/islr/">Home</a>

    
    
      
    
      
        
      
    
      
    
      
        
          
          <a class="sidebar-nav-item" href="/islr/ch02/">2. Statistical Learning</a>
        
      
    
      
        
      
    
      
        
          
          <a class="sidebar-nav-item" href="/islr/ch03/">3. Linear Regression</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          
          <a class="sidebar-nav-item" href="/islr/ch04/">4. Logistic Regression</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          
          <a class="sidebar-nav-item" href="/islr/ch05/">5. Resampling Methods</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          
          <a class="sidebar-nav-item" href="/islr/ch06/">6. Linear Model Selection and Regularization</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          
          <a class="sidebar-nav-item" href="/islr/ch07/">7. Moving Beyond Linearity</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          
          <a class="sidebar-nav-item" href="/islr/ch08/">8. Tree-Based Methods</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          
          <a class="sidebar-nav-item" href="/islr/ch09/">9. Support Vector Machines</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          
          <a class="sidebar-nav-item" href="/islr/ch10/">10. Unsupervised Learning</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
    
      
    
      
    
      
    

  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2019.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/islr/" title="Home">islr</a>
            <small>notes and exercises from An Introduction to Statistical Learning</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="page">
  <h1 class="page-title">4. Logistic Regression</h1>
  	
<h1 id="exercise-11-classify-highlow-mpg-cars-in-auto-dataset">Exercise 11: Classify high/low <code class="highlighter-rouge">mpg</code> cars in <code class="highlighter-rouge">Auto</code> dataset</h1>

<div class="toc">
  <ul class="toc-item">
    <li><span><a href="#prepare-the-dataset" data-toc-modified-id="Prepare-the-dataset-1">Prepare the dataset</a></span></li>
    <li><span><a href="#a-create-high-and-low-mpg-classes" data-toc-modified-id="a.-Create-high-and-low-mpg-classes-2">a. Create high and low mpg classes</a></span></li>
    <li><span><a href="#b-visual-feature-selection" data-toc-modified-id="b.-Visual-feature-selection-3">b. Visual feature selection</a></span>
      <ul class="toc-item">
        <li><span><a href="#quantitative-features" data-toc-modified-id="Quantitative-features-3.1">Quantitative features</a></span></li>
        <li><span><a href="qualitative-features" data-toc-modified-id="Qualitative-features-3.2">Qualitative features</a></span></li>
      </ul>
    </li>
    <li><span><a href="#c-train-test-split" data-toc-modified-id="c.-Train-test-split-4">c. Train-test split</a></span></li>
    <li><span><a href="#d-lda-model" data-toc-modified-id="d.-LDA-model-5">d. LDA model</a></span></li>
    <li><span><a href="#e-qda-model" data-toc-modified-id="e.-QDA-model-6">e. QDA model</a></span></li>
    <li><span><a href="#f-logit-model" data-toc-modified-id="f.-Logit-model-7">f. Logit model</a></span></li>
    <li><span><a href="#g-knn-model" data-toc-modified-id="g.-KNN-model-8">g. KNN model</a></span></li>
  </ul>
</div>

<h2 id="prepare-the-dataset">Prepare the dataset</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">auto</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'http://www-bcf.usc.edu/~gareth/ISL/Auto.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">### </span>
<span class="c">## impute missing horsepower values with mean</span>
<span class="c">#</span>

<span class="c"># replace `?` with 0 so means can be calculated</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">auto</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">auto</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'horsepower'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'?'</span><span class="p">:</span>
        <span class="n">auto</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'horsepower'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c"># cast horsepower to numeric dtype</span>
<span class="n">auto</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">:</span> <span class="p">,</span> <span class="s">'horsepower'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">auto</span><span class="o">.</span><span class="n">horsepower</span><span class="p">)</span>

<span class="c"># now impute values</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">auto</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">auto</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'horsepower'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">auto</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'horsepower'</span><span class="p">]</span> <span class="o">=</span> <span class="n">auto</span><span class="p">[</span><span class="n">auto</span><span class="o">.</span><span class="n">cylinders</span> <span class="o">==</span> <span class="n">auto</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s">'cylinders'</span><span class="p">]]</span><span class="o">.</span><span class="n">horsepower</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="a-create-high-and-low-mpg-classes">a. Create high and low mpg classes</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># represent high mpg as mpg above the median</span>
<span class="n">auto</span><span class="p">[</span><span class="s">'mpg01'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">auto</span><span class="o">.</span><span class="n">mpg</span> <span class="o">&gt;</span> <span class="n">auto</span><span class="o">.</span><span class="n">mpg</span><span class="o">.</span><span class="n">median</span><span class="p">())</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'int32'</span><span class="p">)</span>
<span class="n">auto</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-aligned: middle;
    }

    .dataframe tbody tr th {
        vertical-aligned: top;
    }

    .dataframe thead th {
        text-aligned: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-aligned: right;">
      <th></th>
      <th>mpg</th>
      <th>cylinders</th>
      <th>displacement</th>
      <th>horsepower</th>
      <th>weight</th>
      <th>acceleration</th>
      <th>year</th>
      <th>origin</th>
      <th>name</th>
      <th>mpg01</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>8</td>
      <td>307.0</td>
      <td>130.0</td>
      <td>3504</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>chevrolet chevelle malibu</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15.0</td>
      <td>8</td>
      <td>350.0</td>
      <td>165.0</td>
      <td>3693</td>
      <td>11.5</td>
      <td>70</td>
      <td>1</td>
      <td>buick skylark 320</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>8</td>
      <td>318.0</td>
      <td>150.0</td>
      <td>3436</td>
      <td>11.0</td>
      <td>70</td>
      <td>1</td>
      <td>plymouth satellite</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16.0</td>
      <td>8</td>
      <td>304.0</td>
      <td>150.0</td>
      <td>3433</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>amc rebel sst</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17.0</td>
      <td>8</td>
      <td>302.0</td>
      <td>140.0</td>
      <td>3449</td>
      <td>10.5</td>
      <td>70</td>
      <td>1</td>
      <td>ford torino</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">auto</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 397 entries, 0 to 396
Data columns (total 10 columns):
mpg             397 non-null float64
cylinders       397 non-null int64
displacement    397 non-null float64
horsepower      397 non-null float64
weight          397 non-null int64
acceleration    397 non-null float64
year            397 non-null int64
origin          397 non-null int64
name            397 non-null object
mpg01           397 non-null int32
dtypes: float64(4), int32(1), int64(4), object(1)
memory usage: 29.5+ KB
</code></pre></div></div>

<p>Note high <code class="highlighter-rouge">mpg</code> is represented by class 1</p>

<h2 id="b-visual-feature-selection">b. Visual feature selection</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">'white'</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">warnings</span>  
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">'ignore'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="quantitative-features">Quantitative features</h3>

<p>We’ll inspect some plots of the quantitative variables against the high/low classes first.</p>

<p>Of course, <code class="highlighter-rouge">mpg</code> will completely separate classes, which is unsurprising. We won’t use this feature in our models, since it seems like cheating and/or makes the exercise uninteresting.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"mpg01"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"mpg"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/islr/assets/images/ch04_exercise_11_13_0.png" alt="png" /></p>

<p>Now let’s look at the other quanitative features</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"mpg01"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"displacement"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"mpg01"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"displacement"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/islr/assets/images/ch04_exercise_11_15_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"mpg01"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"horsepower"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"mpg01"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"horsepower"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/islr/assets/images/ch04_exercise_11_16_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"mpg01"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">'violin'</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"mpg01"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"weight"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/islr/assets/images/ch04_exercise_11_17_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"mpg01"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"acceleration"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"mpg01"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"acceleration"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/islr/assets/images/ch04_exercise_11_18_0.png" alt="png" /></p>

<p>Since the number of unique values for <code class="highlighter-rouge">year</code> is small</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">auto</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82])
</code></pre></div></div>

<p>one might argue it should be trasted as a qualitative variable. However, since there it has a natural (time) ordering we treat it as quantitative</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"mpg01"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"year"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">'violin'</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"mpg01"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"year"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/islr/assets/images/ch04_exercise_11_22_0.png" alt="png" /></p>

<p>With the exception of <code class="highlighter-rouge">acceleration</code> and possibly year, all these plots show a good separation of the distributions across the <code class="highlighter-rouge">mpg</code> classes. Based on these plots, all the quantitative variable except <code class="highlighter-rouge">acceleration</code> look like useful features for predicting <code class="highlighter-rouge">mpg</code> class.</p>

<h3 id="qualitative-features">Qualitative features</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"cylinders"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'mpg01'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">'count'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/islr/assets/images/ch04_exercise_11_25_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"origin"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'mpg01'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">'count'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/islr/assets/images/ch04_exercise_11_26_0.png" alt="png" /></p>

<p>Since <code class="highlighter-rouge">cylinders</code> and <code class="highlighter-rouge">origin</code> separate the <code class="highlighter-rouge">mpg</code> classes well they both should be useful predictors.</p>

<p>Note: we’re going to ignore <code class="highlighter-rouge">name</code> for now. This is a categorical variable but it has a lot of levels</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">len</span><span class="p">(</span><span class="n">auto</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>304
</code></pre></div></div>

<p>and analysis is likely a bit complicated</p>

<h2 id="c-train-test-split">c. Train-test split</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sklearn.model_selection</span> <span class="k">as</span> <span class="n">skl_model_selection</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="n">sm</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">auto</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'acceleration'</span><span class="p">,</span> <span class="s">'mpg01'</span><span class="p">,</span> <span class="s">'name'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">auto</span><span class="o">.</span><span class="n">mpg01</span><span class="o">.</span><span class="n">values</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">skl_model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="d-lda-model">d. LDA model</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sklearn.discriminant_analysis</span> <span class="k">as</span> <span class="n">skl_discriminant_analysis</span>

<span class="n">LDA_model</span> <span class="o">=</span> <span class="n">skl_discriminant_analysis</span><span class="o">.</span><span class="n">LinearDiscriminantAnalysis</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sklearn.metrics</span> <span class="k">as</span> <span class="n">skl_metrics</span>

<span class="n">skl_metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">LDA_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.93
</code></pre></div></div>

<p>Impressive!</p>

<h2 id="e-qda-model">e. QDA model</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QDA_model</span> <span class="o">=</span> <span class="n">skl_discriminant_analysis</span><span class="o">.</span><span class="n">QuadraticDiscriminantAnalysis</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">skl_metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">QDA_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.48
</code></pre></div></div>

<p>Much worse :(</p>

<h3 id="f-logit-model">f. Logit model</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sklearn.linear_model</span> <span class="k">as</span> <span class="n">skl_linear_model</span>

<span class="n">Logit_model</span> <span class="o">=</span> <span class="n">skl_linear_model</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">skl_metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">Logit_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.94
</code></pre></div></div>

<p>Better!</p>

<h3 id="g-knn-model">g. KNN model</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sklearn.neighbors</span> <span class="k">as</span> <span class="n">skl_neighbors</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">accuracies</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">'KNN'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">skl_neighbors</span><span class="o">.</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">accuracies</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">skl_metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">accuracies</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s">'columns'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div>
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-aligned: middle;
    }

    .dataframe tbody tr th {
        vertical-aligned: top;
    }

    .dataframe thead th {
        text-aligned: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-aligned: right;">
      <th></th>
      <th>KNN5</th>
      <th>KNN9</th>
      <th>KNN10</th>
      <th>KNN3</th>
      <th>KNN7</th>
      <th>KNN1</th>
      <th>KNN6</th>
      <th>KNN8</th>
      <th>KNN4</th>
      <th>KNN2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.83</td>
      <td>0.83</td>
      <td>0.83</td>
      <td>0.82</td>
      <td>0.82</td>
      <td>0.8</td>
      <td>0.8</td>
      <td>0.8</td>
      <td>0.76</td>
      <td>0.7</td>
    </tr>
  </tbody>
</table>
</div>

<p>These values are all really close, except perhaps <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>=</mo><mn>2</mn><mo separator="true">,</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">N=2,4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span></span></span></span>. Given the bias-variance tradeoff, we’d probably want to select <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">N=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">N=5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span></span></span></span> based on these results</p>


</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', functione. {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
